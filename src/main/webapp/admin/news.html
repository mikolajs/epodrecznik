<!doctype HTML>
<html>
    
<div class="lift:surround?with=admin;at=boxText">
    <head_merge>
       
    <script >
   
       var oTable = $();
         
     
      $(document).ready(function() {
                        $('#newsList').children('table').children('tbody').children('tr').each(function(){
                            $(this).dblclick(function(){beginEditNews(this);});
                        });
                        
                         oTable = $('#dataTable').dataTable();
                
            
                        
                        $('#newsForm').dialog({
                            autoOpen: false,
                            height: 400,
                            width: 600,
                            modal: true,
                            close: function(){
                               
                            }
                        });
                    });
                    
                      
                    
            function beginEditNews(elem){
                 $('#newsForm').dialog("open");
                 $elem = $(elem);
                 $('#editId').val($elem.attr('id'));
                 
                 $elem.children('td').each(function(index) {
                  switch(index){
                  case 0:
                  $('#editTitle').val(this.innerHTML);
                  break;
                  case 1:
                  var src = $(this).children('img').first().attr('src');
                  $('#imagePreview').attr('src',src);
                  break;
                  case 2:
                  $('#editContent').val(this.innerHTML);
                  break;
                  case 3:
                  $('#editLink').val(this.innerHTML);
                  break;
                  default:
                  break;
                  }
                 });
                 
            }
            
            function mkAddNews(){
                 $('#newsForm').dialog("open");
            }
            
          //get url from iframe in CKEditor and insert it in url input in window massage
    		function getImageURLfromIFrame(elem){
    			var innerDoc = elem.contentDocument || elem.contentWindow.document;
    			var url  = innerDoc.getElementById('path').value;
    			$('#pathImg').val(url);
    		}
           
            </script>
    </head_merge>
   
  <h2>Administracja - Linki</h2>
    <div class="lift:Administration.shortLink dataTable_wrapper" id="newsList">
            
            <table  id="dataTable" class="display">
            <thead><tr><th>Temat</th><th>Obraz</th><th>Treść</th> <th>Link</th></tr></thead>
            <tbody><tr><td></td><td></td><td></td> <td></td></tr></tbody>
            </table>    
             <input id="mkAddNews" type="image" src="/images/addico.png" onclick="mkAddNews();"/>    
    </div>
  
  <div id="newsForm" style="display:none;" title="Edycja newsów">
   <form class="lift:Administration.editLink?form=POST"  >
     
          <input id="editId"/>
          <p><label for="editTitle">Tytuł:</label><input width="200px" id="editTitle"/>
          <input id="pathImg" type="text" /><img src="" id="imagePreview"></p>
          <iframe src="/imgstorage" style="width:500px;height:100px;" onload="getImageURLfromIFrame(this)"></iframe>
          <p><label for="editLink">Link:</label><input width="200px" id="editLink"/></p>
          <p><label for="editContent">Opis:</label><textarea id="editContent" width="200px" ></textarea></p>
          <p><input id="editDelete"/><input id="editSave"/></p>
          
     
      </form>
  </div>
  <br/>
</div>

</html>